@echo off

echo ## 基础信息 > res.md
echo ```>> res.md
echo 系统结构: %PROCESSOR_ARCHITECTURE% >> res.md
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" >> res.md
systeminfo | findstr /B /C:"OS 名称" /C:"OS 版本" >> res.md
echo ```>> res.md

echo ## 网络配置 >> res.md
echo ```>> res.md
ipconfig /all >> res.md
echo ```>> res.md

echo ## 补丁信息 >> res.md
echo ```>> res.md
systeminfo | findstr /C:"KB" >> res.md
echo ```>> res.md

echo ## 查看进程 >> res.md
echo ```>> res.md
tasklist /svc >> res.md
echo ```>> res.md

echo ## 用户信息 >> res.md
echo ```>> res.md
whoami /all >> res.md
echo ```>> res.md

echo ## 用户列表 >> res.md
echo ```>> res.md
net user >> res.md
net localgroup Administrators >> res.md
echo ```>> res.md

echo ## 在线用户 >> res.md
echo ```>> res.md
query user || qwinsta >> res.md
echo ```>> res.md

echo ## 端口信息 >> res.md
echo ```>> res.md
netstat -ano >> res.md
echo ```>> res.md

echo ## 共享列表 >> res.md
echo ```>> res.md
net share  >> res.md
echo ```>> res.md

echo ## 路由信息 >> res.md
echo ```>> res.md
route print  >> res.md
echo ```>> res.md

echo ## ARP缓存表 >> res.md
echo ```>> res.md
arp -a >> res.md
echo ```>> res.md

echo ## 防火墙配置 >> res.md
echo ```>> res.md
netsh firewall show config >> res.md
echo ```>> res.md

echo ## 代理配置 >> res.md
echo ```>> res.md
reg query "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" | findstr -C:"ProxyEnable" -C:"ProxyServer" >> res.md
echo ```>> res.md

echo ## 远程连接 >> res.md
echo ```>> res.md
reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" | findstr -C:"PortNumber" >> res.md
echo ```>> res.md